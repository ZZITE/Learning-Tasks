{% extends './base.html' %}
{% block content %}
          <div class="container-fluid">
            <div class="row content">
              <form data-toggle="validator" role="form" method="post">
              <div class="col-md-6 pull-right col-xs-12">
                <div style="margin-top:10%;" class="hidden-xs hidden-sm" ></div>
                <div class="row">
                    <h2 style="margin-bottom:10px;"><i class="fa fa-shopping-cart detail-tittle"></i>Order Summary</h2>
                  <div class="col-md-4 col-sm-4 col-xs-12 cart-img">
                    <img src="{{ static_url('images/goods_show.jpg') }}"/>
                    <a class="question-link">
                      *Minus shipping and handling. LEARN WHY WE CHARGE.<i class="fa question fa-question-circle-o" aria-hidden="true"></i></a>
                  </div>
                  <div class="col-md-5 col-sm-7 col-xs-12">
                    <table class="cart-table">
                      <thead></thead>
                      <tbody>
                        <tr>
                          <td>
                            <span class="key">product</span>
                          </td>
                          <td>
                            <span class="val">Legging</span>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <span class="key">Color</span>
                          </td>
                          <td>
                            <a title="Black"><span class="color"></span></a>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <span class="key">Size</span>
                          </td>
                          <td>
                          <div class=" size-radio">
                          <div class="form-group">
                            <div class="form-inline">
                              <div class="radio">
                                <label>
                                  <span class="product-size text-center ">XS</span>
                                  <input class="hidden" type="radio" name="size" value="XS" required data-error="Size required!">
                                </label>
                              </div>
                              <div class="radio">
                                <label>
                                  <span class="product-size text-center ">S</span>
                                  <input class="hidden" type="radio" name="size" value="S" required data-error="Size required!">
                                </label>
                              </div>
                              <div class="radio">
                                <label>
                                  <span class="product-size text-center">M</span>
                                  <input class="hidden" type="radio" value="M" name="size" required data-error="Size required!">
                                </label>
                              </div>
                              <div class="radio">
                                <label>
                                  <span class="product-size text-center ">L</span>
                                  <input class="hidden" type="radio" name="size" value="L" required data-error="Size required!">
                                </label>
                              </div>
                              <div class="radio">
                                <label>
                                  <span class="product-size text-center ">XL</span>
                                  <input class="hidden" type="radio" name="size" value="XL" required data-error="Size required!">
                                </label>
                              </div>
                            </div>
                            <div class="help-block with-errors"></div>
                          </div>
                          </div>
                            

                            
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <span class="key">QTY</span>
                          </td>
                          <td>
                            <input type="number" name="quantity" value="1" min="1" class="quantity-input">
                          </td>
                        </tr>
                        <tr>
                            <td colspan="2"><div style="BORDER-TOP: #333 1px solid; OVERFLOW: hidden; HEIGHT: 1px"></div></td>
                        </tr>

                          
                        <tr>
                          <td>
                            <span class="key">Traditional Retail</span>
                          </td>
                          <td>
                            <span class="retail"><del style="color:#E27F60">$<span class="price">100.00</span></del></span>
                          </td>
                        </tr>
                        
                        <tr>
                          <td>
                            <span class="key">Donate</span>
                          </td>
                          <td>
                            <span class="val">$<span class="subtotal">0.99</span></span>
                          </td>
                        </tr>

                        <tr>
                          <td>
                            <span class="key">Shipping</span>
                          </td>
                          <td>
                            <span class="val">$<span class="shopping">19.00</span></span>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="2"><div style="BORDER-TOP: #333 1px solid; OVERFLOW: hidden; HEIGHT: 1px"></div></td>
                        </tr>

                        <tr>
                          <td>
                            <span class="val">Total</span>
                          </td>
                          <td>
                            USD $<span style="font-size:18px;" class="total val">19.99</span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <div class="form-group text-right">
                        <button type="submit" class="btn btn-primary confirm-btn">Continue</button>
                    </div>
                    <span class="error-mes">{% if error_message %}{{ error_message }}{% end %}</span>
                  </div>
                  <div class="col-md-1"></div>
                </div>
              </div>

              <div class="col-md-6 pull-left col-xs-12">
                <div style="margin-top:10%;" class="hidden-xs hidden-sm" ></div>
                <div class="row">
                  <div class="col-md-3 hidden-xs"></div>
                  <div class="col-md-8 col-xs-12">

                      <h2 style="margin-bottom:10px;"><i class="fa fa-truck fa-flip-horizontal detail-tittle"></i>Delivery Details</h2>

                      <div class="form-group">
                        <label for="inputEmail" class="control-label">Email</label>
                        <input type="email" name="email" class="form-control"
                               id="inputEmail" placeholder="Email" data-error="that email address is invalid" required>
                        <div class="help-block with-errors"></div>
                      </div>

                      <div class="form-group">
                        <label for="phone" class="control-label">Phone</label>
                        <input type="text" name="phone" class="form-control"
                               id="phone" placeholder="Phone (optional)">
                      </div>

                      <div class="form-group">
                        <div class="form-inline row">
                          <div class="form-group col-sm-6 col-xs-6">
                              <label for="FirstName" class="control-label">First Name</label></br>
                              <input type="text" name="firstName" class="form-control" id="FirstName" placeholder="First Name" required style="width:100%">
                          </div>
                          <div class="form-group col-sm-6 col-xs-6">
                              <label for="LastName" class="control-label">Last Name</label></br>
                              <input type="text" name="lastName" class="form-control" id="LastName" placeholder="Last Name" required style="width:100%">
                          </div>
                        </div>
                      </div>

                      <div class="form-group">
                          <div class="form-inline row">
                              <div class="form-group col-sm-6 col-xs-6">
                                  <label for="Address" class="control-label">Address</label></br>
                                  <input type="text" name="address" class="form-control" id="Address" placeholder="Address" required style="width:100%">
                              </div>
                              <div class="form-group col-sm-6 col-xs-6">
                                  <label for="State" class="control-label">State/Province</label></br>
                                  <input type="text" name="state" class="form-control" id="State" placeholder="State/Province" required style="width:100%">
                              </div>
                          </div>
                      </div>


                      <div class="form-group">
                          <div class="form-inline row">
                              <div class="form-group col-sm-6">
                                  <label for="city" class="control-label">City</label></br>
                                  <input type="text" name="city" class="form-control" id="city" placeholder="City" required style="width:100%">
                              </div>
                              <div class="form-group col-sm-3">
                                  <label for="code" class="control-label">post code</label></br>
                                  <input type="text" name="zipcode" class="form-control" id="code" placeholder="post code" required style="width:100%">
                              </div>
                              <div class="form-group col-sm-3">
                                  <label for="country" style="margin-bottom:0;">Country</label></br>
                                  <select style="width:100%;font-size:13px;" class="form-control" name="country" id="country" required>
                                      <option data-code="US" value="UnitedStates">United States</option>
                                      <option data-code="AU" value="Australia">Australia</option>
                                      <option data-code="CA" value="Canada">Canada</option>
                                      <option data-code="GB" value="UnitedKingdom">United Kingdom</option>
                                      <option data-code="FR" value="France">France</option>
                                      <option data-code="RU" value="Russia">Russia</option>
                                      <option data-code="DE" value="Germany">Germany</option>
                                      <option data-code="JP" value="Japan">Japan</option>
                                      <option data-code="SG" value="Singapore">Singapore</option>
                                  </select>
                              </div>
                          </div>
                          <div  style="margin-top:10px;">
                            <h2 style="margin-bottom:30px;"><i class="fa fa-credit-card detail-tittle"></i>Payment Methods</h2>
                              <div class="form-group">
                                <div >
                                  <label class="pull-left" style="margin-right:30px;width:50%;">
                                    <input checked="true" type="radio" name="payment" value="paypal">
                                    <img src="{{ static_url('images/paypal.png')}}" />
                                  </label>
                                  <div class="pull-right" style="margin-top:8px;">
                                      <img src="{{ static_url('images/nd.png')}}" />
                                      <img src="{{ static_url('images/mc.png')}}" />
                                  </div>
                                </div>
                              </div>
                          </div>
                      </div>

                    </div>
                </div>
            </div>
          </form>
        </div>
      </div>
        <div class="dialog_mask hide" onclick="dialog_hide()"></div>
        <div class="dialog_container hide" id="charge_dialog">
            <span class="dialog_close" onclick="dialog_hide()"><i class="fa fa-times" aria-hidden="true"></i></span>
            <h2>Why do we charge shipping and handling?</h2>
            <p>Shipping around the world is expensive, and the only way to make it cheap is to ignore its impact on people and the environment.</p>
            <br>
            <p>We ship directly from our factory in China, and our packaging is post-consumer recycled and offset by planting three adorable baby trees for each parcel. By charging sustainable shipping rates, we can do all that and provide fair wages to everyone in our supply chain.</p>
            <br>
            <p>Thanks for helping us do it right.</p>
        </div>
{% end %}

{% block js %}
<script>
  var dialog_hide = function() {
      $('.dialog_mask').addClass('hide');
      $('.dialog_container').addClass('hide');
  }
  $('.question-link').click(function () {
      $('.dialog_mask').removeClass('hide');
      $('.dialog_container').removeClass('hide');
  })

  $(function(){
    $('.radio input').change(function(){
      $('.radio input').siblings().removeClass('sizeactive');
      $(this).siblings().addClass('sizeactive');
    });

    $('.quantity-input').change(function () {
      var qut = $('.quantity-input').val();
      var price = 100.00 * qut;
      price = toDecimal2(price);
      var subtotal = 0.99 * qut ;
      subtotal = toDecimal2(subtotal);
      var shopping = 19.00 * qut ;
      shopping = toDecimal2(shopping);
      var total = toDecimal2(Number(subtotal) + Number(shopping));
      $('.price').html(price);
      $('.subtotal').html(subtotal);
      $('.shopping').html(shopping);
      $('.total').html(total);
    });

    // 获取字符
    var input_list = $("input[name]");
    for (var i = 0; i <= input_list.length; i++) {
        var input_elem = $(input_list[i]);
        var name_attr = input_elem.attr('name');
        var cookie_value = getCookie(name_attr);
        var type_pattern = new RegExp('text|email', 'i');        // 这个type的输入框直接替换文字

        if (type_pattern.test(input_elem.attr("type")))
            input_elem.val(cookie_value);
        else if (input_elem.attr("type") === 'number') {
            input_elem.val(cookie_value || 1);
        }
        else if (input_elem.val() === cookie_value) {
            input_elem.attr("checked", true);
            input_elem.siblings().addClass('sizeactive');
        }
    }
    // 国家下拉框
    $("#country > option").each(function(index, element) {
        if ($(element).val() === getCookie('country')) {
          $(element).attr("selected", true);
        }
    })


    function getCookie(name) {
        var r = document.cookie.match("\\b" + name + "=\"?([^;]*)\\b");
        return r ? unescape(r[1]) : undefined;
    }
    /*强制保留两位小数*/
    function toDecimal2(x) {    
        var f = parseFloat(x);    
        if (isNaN(f)) {    
            return false;    
        }    
        var f = Math.round( x * 100)/100;    
        var s = f.toString();    
        var rs = s.indexOf('.');    
        if (rs < 0) {    
            rs = s.length;    
            s += '.';    
        }    
        while (s.length <= rs + 2) {    
            s += '0';    
        }    
        return s;    
    }    

    $('form').validator().on('submit', function (e) {
      if (e.isDefaultPrevented()) {
        return;
      } else {
        var mask = $('<div class="mask"><div class="loading"><h3>Turn to PayPal</h3><span></span><span></span><span></span><span></span><span></span></div></div>');
        $('body').append(mask);
      }
    })
  });

</script>
{% end %}

